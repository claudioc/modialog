/*
* jQuery Modialog plugin 1.2
*
* Copyright (c) 2011 Claudio Cicali <claudio.cicali@gmail.com
*
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
*/
(function(c){function i(a,b){var d=b.data("modialogOptions");if(c.isFunction(d[a]))return d[a].apply(b);return null}function f(a,b,d){if(a||e)if(a||!e||e.data("modialogOptions").closeWithClick){var a=a?a:e,l=a.data("modialogOptions");if(b||!l.locked)l.closeWithEsc&&c(window).unbind("keypress.modialog"),c(window).unbind("resize.modialog"),h.hide(),a.hide(),a.html(a.data("modialogContent")),e=null,i("onClose",a),d&&d.apply(a)}}function j(a){var b=a.data("modialogOptions");h.hide().css({width:c(window).width(),
height:c(window).height()}).show();var d=0|c(document).scrollTop()+(c(window).height()-a.height())/2+b.offsetTop;a.css({"z-index":"1001",position:"absolute",top:d<0?0:d,left:0|(c(window).width()-a.width())/2+b.offsetLeft})}var h=null,n={closeWithEsc:!1,closeWithClick:!1,locked:!1,icon:"X",title:"",offsetTop:0,offsetLeft:0},g,m,e=null,k={init:function(a){var a=a||{},b={};c.extend(b,n);c.extend(b,a);this.data("modialogOptions",b);this.data("modialogContent",this.html());h||(h=c("<div/>").css({display:"none",
position:"fixed",top:0,left:0,opacity:0.6,"z-index":"1000"}).addClass("modialog-overlay").appendTo("body").click(function(a){a.stopPropagation();a.preventDefault();f();return!1}))},set:function(a){var b=this.data("modialogOptions");for(key in a)b[key]=a[key];this.data("modialogOptions",b)},center:function(){this.is(":visible")&&j(this)},lock:function(){var a=this.data("modialogOptions");a.locked=!0;this.data("modialogOptions",a)},unlock:function(){var a=this.data("modialogOptions");a.locked=!1;this.data("modialogOptions",
a)},load:function(a,b,d){var c=this;c.find(a).load(b,function(){c.modialog("open");c.modialog("center");d&&d.apply(c)})},open:function(a){var b=this,d=this.data("modialogOptions");if(!this.is(":visible")){e&&f(e);e=b;d.closeWithEsc&&c(window).bind("keypress.modialog",function(a){27==a.keyCode&&!1!==i("onBeforeClose",b)&&f(b)});c(window).bind("resize.modialog",function(){j(b)});if(d.title!=""||d.icon!="")g=c('<div class="modialog-caption"/>'),d.title!=""&&g.html(d.title),g.prependTo(this);!d.locked&&
d.icon!=""&&g&&(m=c('<div class="modialog-icon">'+d.icon+"</div>"),m.appendTo(g).click(function(){!1!==i("onBeforeClose",b)&&f(b)}));j(b);this.show();a&&a.apply(b);return this}},close:function(){this.is(":visible")&&f(this,!0);return this}};c.fn.modialog=function(a){if(c.isFunction(k[a]))return k[a].apply(this,Array.prototype.slice.call(arguments,1));else if(c.isPlainObject(a)||typeof a=="undefined")return k.init.apply(this,arguments);else c.error("Method "+a+" does not exist on jQuery.modialog")}})(jQuery);
